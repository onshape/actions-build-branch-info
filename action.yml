name: 'actions-build-branch-info'
description: 'Return the active build branch names'
inputs:
  exclude-master:
    description: 'Set true to exclude returning the master branch ex: for jobs like ios-democ-test'
    default: false
outputs:
  branches-json:
    description: "branch names in a JSON list"
    value: ${{ steps.branches.outputs.value }}

runs:
  using: "composite"
  steps:
    - name: Branches
      id: branches
      shell: bash
      run: |
        set -x
        echo "DEBUG exclude-master ..:${{ inputs.exclude-master }}:.."
        json_str=""
        for item in ${{ env.BRANCH_NAMES }}; do
            if [[ "${{ inputs.exclude-master }}" == "true" && "$item" == "master" ]]; then
                :
            elif [[ "$json_str" == "" ]]; then
                json_str="\"$item\""
            else
                json_str="$json_str, \"$item\""
            fi
        done
        echo "::set-output name=value::[${json_str}]"
      env:
        BRANCH_NAMES: "master rel-1.129 rel-1.128"
